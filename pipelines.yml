resources:
- name: RobiNino_npm_example_pipelines_gitResource
  type: GitRepo
  configuration:
    path: RobiNino/npm-example-pipelines
    gitProvider: github_robi
    buildOn:
      pullRequestCreate: true
    branches:
      include: main
- name: RobiNino_npm_example_pipelines_biResource
  type: BuildInfo
  configuration:
    sourceArtifactory: robindev
pipelines:
  - name: RobiNino_npm_example_pipelines_pipeline
    steps:
      - name: NpmBuild
        type: NpmBuild
        configuration:
          environmentVariables:
            'JFROG_CLI_BUILD_URL': $step_url
            'JFROG_BUILD_STATUS': 'PASS'
          resolverRepo: global-npm
          integrations:
            - name: robindev
          inputResources:
            - name: RobiNino_npm_example_pipelines_gitResource
          outputResources:
            - name: RobiNino_npm_example_pipelines_biResource
        execution:
          onFailure:
            - export JFROG_BUILD_STATUS=FAIL
            - jfrog rt bce
            - jfrog rt bp
      - name: publishBuildInfoStep
        type: PublishBuildInfo
        configuration:
          forceXrayScan: true
          inputSteps:
            - name: NpmBuild
          outputResources:
            - name: RobiNino_npm_example_pipelines_biResource
